!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("golden-layout"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-golden-layout",["exports","@angular/core","rxjs","golden-layout","rxjs/operators","@angular/common"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["ngx-golden-layout"]={},t.ng.core,t.rxjs,t.GoldenLayout,t.rxjs.operators,t.ng.common)}(this,(function(t,e,n,o,i,r){"use strict";function a(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,o.get?o:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var s=a(o),l=new e.InjectionToken("ComponentTypes"),c=new e.InjectionToken("Dependencies");Object.create;function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function p(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}Object.create;var f=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};function h(){if(!m()&&!window.__services&&!window.__serviceConstructors&&(window.__services=new window.Map,window.__serviceConstructors=new window.Map,window.require)){var t=window.open.bind(window);window.open=function(e,n,o,i){var r=t(e,n,o,i);return r.require=window.require,r}}}function m(){try{return!!window.opener&&!!window.opener.location.href}catch(t){return!1}}function g(t){return h(),function(e){var n=e,o=m()?window.opener:window,i=o===window;if(i){var r=o.__serviceConstructors.get(t);if(r&&r!==n)throw new Error("MultiWindowService(): uniqueName "+t+" already taken by "+r+", wanted by "+n);o.__serviceConstructors.set(t,n)}var a=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=o.__services.has(t);if(!r){var a=o.__serviceConstructors.get(t)||n;o.__services.set(t,new(a.bind.apply(a,p([void 0],e))))}return o.__services.get(t)};if(i)for(var s in n)n.hasOwnProperty(s)&&(a[s]=n[s]);try{if(i){var l=Reflect.getMetadata("design:paramtypes",n);Reflect.metadata("design:paramtypes",l)(a)}}catch(t){}return a}}t.PluginURLProvider=function(){function t(){this.loadedURLs=new Map,this.loads=new n.Subject,this.unloads=new n.Subject}return t.prototype.loadRequests$=function(){return this.loads},t.prototype.unloadRequests$=function(){return this.unloads},t.prototype.allPlugins=function(){return p(this.loadedURLs.entries()).map((function(t){return{id:t[0],url:t[1]}}))},t.prototype.requestLoad=function(t,e){var n=this.loadedURLs.get(t);if(n){if(n!==e)throw new Error("Plugin "+t+" is already loaded with another URL")}else this.loadedURLs.set(t,e),this.loads.next({id:t,url:e})},t.prototype.requestUnload=function(t){if(!this.loadedURLs.get(t))throw new Error("Plugin "+t+" is not loaded");this.loadedURLs.delete(t),this.unloads.next(t)},t}(),t.PluginURLProvider.decorators=[{type:e.Injectable}],t.PluginURLProvider=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}([g("_gl__PluginURLProvider")],t.PluginURLProvider);var y=function(){function t(){this.pluginLoaded$=new n.Subject,this.pluginUnloaded$=new n.Subject}return t.prototype.startLoadPlugin=function(){throw new Error("MockPluginRegistry does not support loading/unloading")},t.prototype.startUnloadPlugin=function(){throw new Error("MockPluginRegistry does not support loading/unloading")},t}();y.decorators=[{type:e.Injectable}];var v=function(){function t(t,e,o){var i=this;void 0===t&&(t=[]),this.urlProvider=e,this.injector=o,this.availableDependencies=new Map,this.loadedPlugins=new Map,this.pluginLoaded$=new n.Subject,this.pluginUnloaded$=new n.Subject,console.log("Creating PluginRegistry, got",t.length,"additional dependency modules"),t.forEach((function(t){return i.availableDependencies.set(t.name,t.loader)})),this.patchWindow(),this.urlProvider.loadRequests$().subscribe((function(t){return i.load(t)})),this.urlProvider.allPlugins().forEach((function(t){return i.load(t)}))}return t.prototype.startLoadPlugin=function(t,e){this.urlProvider.requestLoad(t,e)},t.prototype.startUnloadPlugin=function(t){this.urlProvider.requestUnload(t)},t.prototype.waitForPlugin=function(t){var e=this.loadedPlugins.get(t);if(e)return e.module.promise;var n={id:t,module:new f,url:null,script:null,moduleRef:null};return this.loadedPlugins.set(t,n),n.module.promise},t.prototype.patchWindow=function(){var t=this;window.define=function(n,o,i){var r=t.loadedPlugins.get(n);if(r){var a=(o=o.slice(1)).map((function(e){var o=t.availableDependencies.get(e);return o?Promise.resolve(o).catch((function(t){console.warn("Plugin",n,"dependency",e,"but load failed",t)})):(console.warn("Plugin",n,"requested unknown dependency",e),Promise.resolve(void 0))}));Promise.all(a).then((function(o){var a={};i.apply(void 0,p([a],o)),console.log("Plugin",n,"loaded.");var s=a.MODULE;if(!s)return Promise.reject("No MODULE export found");var l=new e.ɵNgModuleFactory(s);r.moduleRef=l.create(t.injector),r.module.resolve(a),t.pluginLoaded$.next({id:r.id,module:r.moduleRef})})).catch((function(t){console.warn("Failed to load plugin",n,"error",t),r.module.reject(t)}))}else console.warn("Unknown plugin called define():",n)},window.define.amd=!0,console.log("Window AMD shim established.")},t.prototype.load=function(t){var e=t.id,n=t.url,o=this.loadedPlugins.get(e);if(o&&o.url){if(o.url!==n)throw new Error("Plugin is already loaded with another URL")}else{o||(o={id:e,module:new f,url:null,moduleRef:null,script:null}),o.url=n,this.loadedPlugins.set(e,o);var i=document.createElement("script");i.onerror=function(t){return o.module.reject(t)},i.type="text/javascript",i.src=n,o.script=i,document.body.appendChild(i)}},t.prototype.unload=function(t){},t}();v.decorators=[{type:e.Injectable}],v.ctorParameters=function(){return[{type:Array,decorators:[{type:e.Inject,args:[c]},{type:e.Optional}]},{type:t.PluginURLProvider},{type:e.Injector}]};var w=new e.InjectionToken("GoldenLayoutContainer"),_=new e.InjectionToken("GoldenLayoutComponentState"),C=new e.InjectionToken("GoldenLayoutEventHub"),b=new e.InjectionToken("GoldenLayoutComponentHost");function I(t){return"object"==typeof t&&"function"==typeof t.glOnResize}function L(t){return"object"==typeof t&&"function"==typeof t.glOnShow}function S(t){return"object"==typeof t&&"function"==typeof t.glOnHide}function x(t){return"object"==typeof t&&"function"==typeof t.glOnTab}var j=function(){function t(t,e,n){this.host=t,this.container=e,this.state=n,this.destroyed=!1,this.initialized=!1,this.originalComponent=this.host.getGoldenLayoutInstance()._getAllComponents()[this.state.originalId]}return Object.defineProperty(t.prototype,"headerComponent",{get:function(){if(this.originalComponent&&this.originalComponent.instance)return this.originalComponent.instance.then((function(t){return t.instance.headerComponent}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"additionalTokens",{get:function(){if(this.originalComponent&&this.originalComponent.instance)return this.originalComponent.instance.then((function(t){return t.instance.additionalTokens}))},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.originalComponent.instance.then((function(e){t.destroyed||t.initialized||(t.redock(e,t.container.getElement()),t.initialized=!0)}))},t.prototype.ngOnDestroy=function(){var t=this;this.originalComponent.instance.then((function(e){t.initialized&&!t.destroyed&&(t.redock(e,t.originalComponent.container.getElement()),t.destroyed=!0)}))},t.prototype.redock=function(t,e){var n=$(t.location.nativeElement);n.remove(),e.append(n),I(t.instance)&&t.instance.glOnResize()},t.prototype.glOnHide=function(){this.originalComponent.instance.then((function(t){S(t.instance)&&t.instance.glOnHide()}))},t.prototype.glOnShow=function(){this.originalComponent.instance.then((function(t){L(t.instance)&&t.instance.glOnShow()}))},t.prototype.glOnResize=function(){this.originalComponent.instance.then((function(t){I(t.instance)&&t.instance.glOnResize()}))},t.prototype.glOnTab=function(t){var e=this;this.originalComponent.instance.then((function(t){x(t.instance)&&t.instance.glOnTab(e.originalComponent.tab)}))},t}();j.decorators=[{type:e.Component,args:[{selector:"gl-wrapper",encapsulation:e.ViewEncapsulation.None,template:'<div class="wrapper"></div>'}]}],j.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[b]}]},{type:void 0,decorators:[{type:e.Inject,args:[w]}]},{type:void 0,decorators:[{type:e.Inject,args:[_]}]}]};var P=function(){function t(t,e){var n,o=this;this.pluginRegistry=e,this.components=new Map,this.awaitedComponents=new Map,(t||[]).forEach((function(t){return o.registerComponent(t)})),this.registerComponent({name:"gl-wrapper",type:j}),null===(n=this.pluginRegistry)||void 0===n||n.pluginLoaded$.subscribe((function(t){var e=t.id,n=t.module.injector.get(l,[]);console.log("Plugin",e,"wants to register",n.length,"components"),n.forEach((function(t){return o.registerComponent(Object.assign(Object.assign({},t),{plugin:e}))}))}))}return t.prototype.registeredComponents=function(){return p(this.components.entries()).map((function(t){return{name:t[0],type:t[1]}}))},t.prototype.componentMap=function(){return this.components},t.prototype.registerComponent=function(t){var e=this.components.get(t.name);if(e&&e!==t.type)throw new Error("Failed to register component, "+t.name+" is already taken by another component: "+e);this.components.set(t.name,t.type);var n=this.awaitedComponents.get(t.name);n&&(this.awaitedComponents.delete(t.name),n.resolve(t.type))},t.prototype.waitForComponent=function(t){var e=this.components.get(t);if(e)return Promise.resolve(e);var n=this.awaitedComponents.get(t);return n||(n=new f,this.awaitedComponents.set(t,n)),n.promise},t}();P.decorators=[{type:e.Injectable}],P.ctorParameters=function(){return[{type:Array,decorators:[{type:e.Inject,args:[l]},{type:e.Optional}]},{type:v,decorators:[{type:e.Optional}]}]};var E=new e.InjectionToken("fallback component"),O=new e.InjectionToken("failed component"),k=function(){function t(){}return t.prototype.isChildWindow=function(){try{return!!window.opener&&!!window.opener.location.href}catch(t){return!1}},t.prototype.getRootWindow=function(){return this.isChildWindow()?window.opener:window},t}();k.decorators=[{type:e.Injectable}],k.ctorParameters=function(){return[]};var R=function(){function t(){}return t.prototype.restoreAppRefTick=function(){},t.prototype.onUnload=function(){},t}();R.decorators=[{type:e.Injectable}];var M=function(){function t(t,e,n){var o=this;this.appref=t,this.rootService=e,this.injector=n,this.unloaded=!1,this.topWindow=this.rootService.getRootWindow(),this.isChildWindow=this.rootService.isChildWindow(),this.isChildWindow&&(window.document.title=window.document.URL,console.__log=console.log,console.log=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=o.topWindow.console).log.apply(t,p(["[CHILD] =>"],e))});var i=this.topWindow;this.isChildWindow||(i.__apprefs=[],i.__injector=this.injector),i.__apprefs.push(this.appref),this.appref.__tick=this.appref.tick,this.appref.tick=function(){var t,e,n=function(t){t._zone.run((function(){return t.__tick()}))};try{for(var i=u(o.topWindow.__apprefs),r=i.next();!r.done;r=i.next()){n(r.value)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}}return t.prototype.restoreAppRefTick=function(){this.appref.tick=this.appref.__tick},t.prototype.onUnload=function(){if(!this.unloaded&&(this.unloaded=!0,this.isChildWindow)){var t=this.topWindow.__apprefs.indexOf(this.appref);t>=0&&this.topWindow.__apprefs.splice(t,1)}},t}();M.decorators=[{type:e.Injectable}],M.ctorParameters=function(){return[{type:e.ApplicationRef},{type:k},{type:e.Injector}]};var U=s,A=function(t){return t.isComponent&&t.config&&t.config.componentState&&t.config.componentState.originalId},D=A,T=function(t,e){var n=t.root.getItemsById(e);if(1===n.length)return n[0];console.warn("non unique ID found: "+e)},W=function(t){var e=T(t.layoutManager,t.config.componentState.originalId);if(!e.isComponent)throw new Error("Expected component");return e},z=W,H=function(t){var e=W(t);return e?e.tab:void 0},G=H,N=U.__lm.controls.Tab,q=function(t,e){var n=new N(t,e);return n.closeElement.off("click touchstart"),n.closeElement.on("click touchstart",(function(t){if(t.stopPropagation(),A(n.contentItem)){var e=W(n.contentItem);e&&e.isComponent&&e.container.close()}else n.contentItem.container.close()})),n.element.on("mousedown touchstart",(function(t){var e=n.contentItem;A(e)&&(e=W(n.contentItem)),e.layoutManager.emit("tabActivated",e)})),A(n.contentItem)&&!0===n._layoutManager.config.settings.reorderEnabled&&n.element.on("mousedown touchstart",(function(e){var o=H(n.contentItem);if(o&&o._dragListener){var i=o._dragListener,r=function(){i.off("dragStart",r,i),t.layoutManager._maximisedItem===n.contentItem.parent&&n.contentItem.parent.toggleMaximise()};i.off("dragStart",o._onDragStart,o),i.on("dragStart",r,i),i.on("dragStart",o._onDragStart,o),i._fDown(e)}})),n},F=q;q._template='<li class="lm_tab"><i class="lm_left"></i><span class="lm_title"></span><div class="lm_close_tab"></div><i class="lm_right"></i></li>',U.__lm.controls.Tab=q;var V=U.__lm.controls.Header,B=function(t,e){var n=e._header.maximise,o=e._header.popout;n&&!0===t.config.settings.maximiseAllItems&&delete e._header.maximise,o&&!0===t.config.settings.maximiseAllItems&&delete e._header.popout;var i=new V(t,e);if(o&&!0===t.config.settings.maximiseAllItems&&(i.popoutButton=new U.__lm.controls.HeaderButton(i,o,"lm_popout",(function(){var e=i.activeContentItem;A(e)?(e=W(e)).popout():!0===t.config.settings.popoutWholeStack?i.parent.popout():e.popout()}))),n&&!0===t.config.settings.maximiseAllItems&&(i.maximiseButton=new U.__lm.controls.HeaderButton(i,n,"lm_maximise",(function(){t._maximisedItem===e?e.toggleMaximise():t.generateAndMaximiseDummyStack(e)}))),i.closeButton){i.closeButton._$destroy();var r=i._getHeaderSetting("close");i.closeButton=new U.__lm.controls.HeaderButton(i,r,"lm_close",(function(){i.parent.contentItems.forEach((function(t){t.container.close()}))}))}return i},Z=B;B._template=['<div class="lm_header">','<ul class="lm_tabs"></ul>','<ul class="lm_controls"></ul>','<ul class="lm_tabdropdown_list"></ul>',"</div>"].join(""),U.__lm.controls.Header=B;var Y=U.__lm.controls.DragProxy,Q=function(t,e,n,o,i,r){return o.emit("itemDragged",i),new Y(t,e,n,o,i,r)},J=Q;Q._template=Y._template,U.__lm.controls.DragProxy=Q;var K=U.__lm.items.Stack;function X(t,e,o){var i=this;K.call(this,t,e,o),this.activeContentItem$=new n.BehaviorSubject(null);var r=function(t){i.activeContentItem$&&i.activeContentItem$.next(t)};this.on("activeContentItemChanged",r);var a=this._$destroy;return this.___destroyed=!1,this._$destroy=function(){i.___destroyed||(i.___destroyed=!0,i.off("activeContentItemChanged",r),i.activeContentItem$.complete(),i.activeContentItem$=null,a.call(i))},this}X.prototype=Object.create(K.prototype),X.prototype.addChild=function(t,e){var n=this;"stack"===t.type?((t.content||[]).forEach((function(t,o){return K.prototype.addChild.call(n,t,e+o)})),t.content.length&&this.setActiveContentItem(this.contentItems[e+t.activeItemIndex])):K.prototype.addChild.call(this,t,e)},X.prototype.setSize=function(){this.layoutManager._maximisedItem===this&&!0===this.layoutManager.config.settings.maximiseAllItems&&(this.element.width(this.layoutManager.container.width()),this.element.height(this.layoutManager.container.height())),K.prototype.setSize.call(this)},U.__lm.items.Stack=X;var tt=U.__lm.controls.BrowserPopout,et=function(t,e,n,o,i){return 1!==t.length?console.warn("This should not happen, permitting",t):"component"===t[0].type&&(t=[{type:"stack",title:t[0].title,content:[t[0]]}]),new tt(t,e,n,o,i)},nt=et;U.__lm.controls.BrowserPopout=et;var ot=U.__lm.utils.getQueryStringParam,it=!0;U.__lm.utils.getQueryStringParam=function(t){return it?(it=!1,ot(t)):null};var rt=function(){function t(t,o,i,r,a,s,l,c,u){var d=this;this.rootService=t,this.componentRegistry=o,this.viewContainer=i,this.componentFactoryResolver=r,this.ngZone=a,this.injector=s,this.windowSync=l,this.parentGoldenLayout=c,this.fallbackComponent=u,this.stateChanged=new e.EventEmitter,this.tabActivated=new e.EventEmitter,this.goldenLayout=null,this.onUnloaded=new f,this.stateChangePaused=!1,this.stateChangeScheduled=!1,this.tabsList=new n.BehaviorSubject({}),this.pushStateChange=function(){d.tabsList.next(d.goldenLayout._getAllComponents()),d.stateChangePaused||d.stateChangeScheduled||(d.stateChangeScheduled=!0,window.requestAnimationFrame((function(){d.stateChangeScheduled=!1,d.stateChanged.emit()})))},this.resumeStateChange=function(){return d.stateChangePaused=!1},this.pauseStateChange=function(){return d.stateChangePaused=!0},this.pushTabActivated=function(t){d.tabActivated.emit(t)},this.fallbackType=null,this.openedComponents=[],this.poppedIn=!1,this._eventEmitter=new U.__lm.utils.EventEmitter,console.log(c),this.fallbackComponent&&(this.fallbackType=this.buildConstructor(this.fallbackComponent)),e.isDevMode()&&console.log("Create@"+(this.rootService.isChildWindow?"child":"root")+"!")}return t.prototype.onResize=function(){this.goldenLayout&&this.goldenLayout.updateSize()},t.prototype.ngOnInit=function(){var t=this;e.isDevMode()&&console.log("Init@"+(this.rootService.isChildWindow?"child":"root")+"!"),this.layoutSubscription=this.layout.subscribe((function(e){t.destroyGoldenLayout(),t.initializeGoldenLayout(e)}))},t.prototype.beforeUnload=function(){var t=this;this.poppedIn&&(this.onUnloaded.promise.then((function(){return t.ngOnDestroy()})),this.onUnloaded.resolve(),this.windowSync.onUnload())},t.prototype.pageHide=function(){var t=this;this.poppedIn||this.openedComponents.forEach((function(t){var e;"object"==typeof(e=t)&&"function"==typeof e.glOnUnload&&t.glOnUnload()})),this.onUnloaded.promise.then((function(){return t.ngOnDestroy()})),this.onUnloaded.resolve(),this.windowSync.onUnload()},t.prototype.ngOnDestroy=function(){var t;e.isDevMode()&&console.log("Destroy@"+(this.rootService.isChildWindow?"child":"root")+"!"),this.layoutSubscription.unsubscribe(),this.windowSync.restoreAppRefTick(),this.destroyGoldenLayout(),this._eventEmitter._mSubscriptions=((t={})[U.__lm.utils.EventEmitter.ALL_EVENT]=[],t)},t.prototype.getGoldenLayoutInstance=function(){if(!this.goldenLayout)throw new Error("Component is not initialized yet");return this.goldenLayout},t.prototype.addEvent=function(t,e,n){this._eventEmitter.on(t,e,n)},t.prototype.getSerializableState=function(){if(this.goldenLayout){var t=this.goldenLayout.toConfig(),e=this.goldenLayout.__wrapperMaximisedItemId;if(e){t.maximisedItemId=e;var n=function(t){return("stack"!==t.type||!t.isDummy)&&("component"!==t.type&&(t.content=t.content.filter(n)),!0)};t.content=t.content.filter(n)}return t}return null},t.prototype.getComponents=function(){return this.goldenLayout._getAllComponents()},t.prototype.closeComponent=function(t){var e=T(this.goldenLayout,t);e&&e.remove()},t.prototype.focusComponent=function(t){var e=T(this.goldenLayout,t);e&&e.parent.setActiveContentItem(e)},t.prototype.createNewComponent=function(t,e){if(!this.goldenLayout)throw new Error("golden layout is not initialized");var n=t,o=this.goldenLayout.root,i=null;if(e){var r=T(this.goldenLayout,e);if(r.parent.isStack)i=r.parent;else{var a=this.goldenLayout.createContentItem({type:"stack",width:r.parent.config.width,height:r.parent.config.height,content:[]});r.parent.replaceChild(r,a,!1),a.addChild(r),i=a}}else o.contentItems&&0!==o.contentItems.length?i=this.findStack(o.contentItems):(i=o,n={type:"stack",content:[Object.assign(Object.assign({},n),{type:"component"})]});if(null===i)throw new Error("this should never happen!");var s=this.goldenLayout.createContentItem(n);return i.addChild(s),s.isComponent?s.instance:s.isStack&&1===s.contentItems.length?s.contentItems[0].instance:s},t.prototype.findStack=function(t){var e,n;if(!t)return null;try{for(var o=u(t),i=o.next();!i.done;i=o.next()){var r=i.value;if(r.isStack){if(r.config.isDummy)continue;return r}var a=this.findStack(r.contentItems);if(null!==a)return a}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},t.prototype.destroyGoldenLayout=function(){this.goldenLayout&&(this.goldenLayout.off("stateChanged",this.pushStateChange),this.goldenLayout.off("itemDropped",this.resumeStateChange),this.goldenLayout.off("itemDragged",this.pauseStateChange),this.goldenLayout.off("tabActivated",this.pushTabActivated),this.goldenLayout.off("initialised"),this.goldenLayout.off(U.__lm.utils.EventEmitter.ALL_EVENT,this._eventEmitter.emit,this._eventEmitter),this.goldenLayout.destroy(),this.goldenLayout=null)},t.prototype.initializeGoldenLayout=function(t){var o=this;this.goldenLayout=new s(t,$(this.el.nativeElement));var r=this.goldenLayout.createPopout.bind(this.goldenLayout);this.goldenLayout.createPopout=function(t,e,n,o){for(var i,a=[t];a.length;){var s=a.shift();if(s.contentItems&&s.contentItems.length>0&&a.push.apply(a,p(s.contentItems)),s.isComponent){var l=s.container.__ngComponent;l&&("object"==typeof(i=l)&&"function"==typeof i.glOnPopout)&&l.glOnPopout()}}return r(t,e,n,o)};var a=function(t){var e,n,o={};try{for(var i=u(t.contentItems),r=i.next();!r.done;r=i.next()){var s=r.value;if(s.isComponent){if(s.config&&s.config.componentState&&s.config.componentState.originalId)continue;o[s.id]=s}else o=Object.assign(Object.assign({},o),a(s))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o};this.goldenLayout._getAllComponents=function(){return a(o.goldenLayout.root)},this.goldenLayout.generateAndMaximiseDummyStack=function(t,e){var r=a(o.goldenLayout.root),s=Object.keys(r);if(0!==s.length){var l=o.goldenLayout.root.contentItems[0];if(l.isStack)l.toggleMaximise();else{var c={type:"stack",content:s.map((function(t){return{type:"component",componentName:"gl-wrapper",title:r[t].config.title,reorderEnabled:!1,componentState:{originalId:t}}})),isClosable:!1,isDummy:!0,state:"dummy",activeItemIndex:s.findIndex((function(n){return n===(e||t._activeContentItem.id)}))};l.addChild(c,0);var d=l.contentItems[0];o.goldenLayout.__wrapperMaximisedItemId=t._activeContentItem.id,d.activeContentItem$.subscribe((function(t){o.goldenLayout.__wrapperMaximisedItemId=t.config.componentState.originalId}));var p=new n.Subject;d.on("minimised",(function(){o.goldenLayout.__wrapperMaximisedItemId=null,p.next(),p.complete(),d.remove()})),d.toggleMaximise(),o.tabsList.pipe(i.takeUntil(p),i.distinctUntilChanged((function(t,e){var n=Object.keys(t),o=new Set(Object.keys(e));return n.length===o.size&&n.every((function(t){return o.has(t)}))}))).subscribe((function(t){var e,n,o,i,r=Object.assign({},t),a=new Set(Object.keys(r)),s=new Set(d.contentItems.map((function(t){return t.config.componentState.originalId})));try{for(var l=u(a),c=l.next();!c.done;c=l.next()){var p=c.value;s.has(p)?s.delete(p):d.addChild({type:"component",componentName:"gl-wrapper",title:t[p].config.title,reorderEnabled:!1,componentState:{originalId:p}})}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}var f=function(t){d.contentItems.find((function(e){return e.config.componentState.originalId===t})).remove()};try{for(var h=u(s),m=h.next();!m.done;m=h.next()){f(m.value)}}catch(t){o={error:t}}finally{try{m&&!m.done&&(i=h.return)&&i.call(h)}finally{if(o)throw o.error}}}))}}},this.goldenLayout.on("popIn",(function(){o.poppedIn=!0,o.openedComponents.forEach((function(t){var e;"object"==typeof(e=t)&&"function"==typeof e.glOnPopin&&t.glOnPopin()}))})),this.goldenLayout.getComponent=function(t){return e.isDevMode()&&console.log("Resolving component "+t),o.buildConstructor(t)},this.goldenLayout.on("stackCreated",(function(t){var r=document.createElement("li");r.classList.add("custom-header"),r.style.display="none";var a=t.header.controlsContainer[0],s=null;a.prepend(r);var l=function(){r.style.display="none",s&&(r.childNodes.forEach((function(t){return r.removeChild(t)})),s.destroy(),s=null,t.header._updateTabSizes())};t.activeContentItem$.pipe(i.switchMap((function(t){return t&&t.isComponent&&t.instance||n.of(null)})),i.switchMap((function(t){if(!t)return Promise.all([null,null,null]);var e=t.instance.headerComponent,n=t.instance.additionalTokens;return Promise.all([Promise.resolve(e),Promise.resolve(n),Promise.resolve(t)])}))).subscribe((function(n){var i=d(n,3),a=i[0],c=i[1],u=i[2];a&&u?function(n,i,a){s&&l(),r.style.display="";var c=o.componentFactoryResolver.resolveComponentFactory(n),u=e.Injector.create(i,a);s=o.viewContainer.createComponent(c,void 0,u),r.prepend(s.location.nativeElement),t.header._updateTabSizes()}(a,c||[],u.injector):l()}),l,l)})),this.goldenLayout.on("initialised",(function(){window.requestAnimationFrame((function(){if(t.maximisedItemId){var e=T(o.goldenLayout,t.maximisedItemId);e&&o.goldenLayout.generateAndMaximiseDummyStack(e.parent,t.maximisedItemId)}}))})),this.goldenLayout.init(),this.goldenLayout.on("stateChanged",this.pushStateChange),this.goldenLayout.on("itemDragged",this.pauseStateChange),this.goldenLayout.on("itemDropped",this.resumeStateChange),this.goldenLayout.on("tabActivated",this.pushTabActivated),this.goldenLayout.on(U.__lm.utils.EventEmitter.ALL_EVENT,this._eventEmitter.emit,this._eventEmitter),this._eventEmitter.emit("initialised")},t.prototype.buildConstructor=function(t){var n=this;return function(o,i){var r=o.parent;r.config.id?r.id=r.config.id:(r.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})),r.config.id=r.id);var a=new f;return n.ngZone.run((function(){n.componentRegistry.waitForComponent(t).then((function(r){e.isDevMode()&&console.log("Component "+t+" returned from componentRegistry");var s=n.componentFactoryResolver.resolveComponentFactory(r),l=null;r===n.fallbackComponent&&(l=o._config.componentName);var c=n._createComponentInjector(o,i,l),u=n.viewContainer.createComponent(s,void 0,c);o.getElement().append($(u.location.nativeElement)),n._bindEventHooks(o,u.instance),o.__ngComponent=u.instance,n.openedComponents.push(u.instance);var d=!1,p=function(){d||(d=!0,n.openedComponents=n.openedComponents.filter((function(t){return t!==u.instance})),$(u.location.nativeElement).remove(),u.destroy())};o.on("destroy",p),n.onUnloaded.promise.then(p),a.resolve(u)}))})),a.promise}},t.prototype._createComponentInjector=function(t,n,o){var i=[{provide:w,useValue:t},{provide:_,useValue:n},{provide:C,useValue:this.goldenLayout.eventHub},{provide:b,useValue:this}];return o&&i.push({provide:O,useValue:o}),e.Injector.create(i,this.injector)},t.prototype._bindEventHooks=function(t,e){if(I(e)&&t.on("resize",(function(){e.glOnResize()})),L(e)&&t.on("show",(function(){e.glOnShow()})),S(e)&&t.on("hide",(function(){e.glOnHide()})),x(e)&&t.on("tab",(function(t){e.glOnTab(t)})),"object"==typeof(o=e)&&"function"==typeof o.glOnClose){var n=t.close.bind(t);t.close=function(){if(!t._config.isClosable)return!1;e.glOnClose().then((function(){n()}),(function(){}))}}var o},t}();rt.decorators=[{type:e.Component,args:[{selector:"golden-layout-root",template:'<div class="ng-golden-layout-root" #glroot></div>',styles:["\n    .ng-golden-layout-root {\n      width:100%;\n      height:100%;\n    }"]}]}],rt.ctorParameters=function(){return[{type:k},{type:P},{type:e.ViewContainerRef},{type:e.ComponentFactoryResolver},{type:e.NgZone},{type:e.Injector},{type:M},{type:rt,decorators:[{type:e.Optional},{type:e.SkipSelf}]},{type:void 0,decorators:[{type:e.Optional},{type:e.Inject,args:[E]}]}]},rt.propDecorators={layout:[{type:e.Input}],stateChanged:[{type:e.Output}],tabActivated:[{type:e.Output}],el:[{type:e.ViewChild,args:["glroot",{static:!0}]}],onResize:[{type:e.HostListener,args:["window:resize"]}],beforeUnload:[{type:e.HostListener,args:["window:beforeunload"]}],pageHide:[{type:e.HostListener,args:["window:pagehide"]}]};var at=function(){function n(){}return n.forRoot=function(o,i,r){return{ngModule:n,providers:[P,k,v,t.PluginURLProvider,M,{provide:l,useValue:o},{provide:e.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:[o,i,j],multi:!0},{provide:c,useValue:r},{provide:E,useValue:i}]}},n.forChild=function(n,o){return[P,{provide:v,useClass:y},{provide:M,useClass:R},{provide:t.PluginURLProvider,useValue:null},{provide:l,useValue:n},{provide:e.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:[n,o,j],multi:!0},{provide:E,useValue:o}]},n}();at.decorators=[{type:e.NgModule,args:[{declarations:[rt,j],exports:[rt],imports:[r.CommonModule]}]}],t.ComponentRegistryService=P,t.FailedComponent=O,t.FallbackComponent=E,t.GetComponentFromLayoutManager=T,t.GoldenLayoutComponent=rt,t.GoldenLayoutComponentHost=b,t.GoldenLayoutComponentState=_,t.GoldenLayoutComponents=l,t.GoldenLayoutContainer=w,t.GoldenLayoutEventHub=C,t.GoldenLayoutModule=at,t.GoldenLayoutPluginDependency=c,t.MockPluginRegistryService=y,t.MultiWindowInit=h,t.MultiWindowService=g,t.PluginRegistryService=v,t.RootWindowService=k,t.isChildWindow=m,t.ɵ0=D,t.ɵ1=z,t.ɵ2=G,t.ɵ3=F,t.ɵ4=Z,t.ɵ5=J,t.ɵ6=nt,t.ɵa=R,t.ɵb=M,t.ɵc=j,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-golden-layout.umd.min.js.map